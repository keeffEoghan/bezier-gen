#!/usr/bin/env node

const yargs = require('yargs');

const { makeBeziers } = require('.');

const { orders, types, name, mix, file } = yargs
    .options({
        'orders': {
            alias: 'o',
            type: 'array',
            description: 'Array of orders in each bezier curve function.'
        },
        'types': {
            alias: 't',
            type: 'array',
            description: 'The GLSL type (dimension) of each bezier curve function - '+
                'may be any GLSL `mix`-able type (`float`, `vec2`, `vec3`, `vec4`).'
        },
        'name': {
            alias: 'n',
            type: 'string',
            description: 'The name to use for the (overloaded) bezier curve function/s.'
        },
        'mix': {
            alias: 'm',
            type: 'string',
            description: 'The name to use for the per-element interpolation function.'
        },
        'file': {
            alias: 'f',
            type: 'string',
            description: 'The output file path for the bezier function/s.'
        }
    })
    .argv;

const beziers = makeBeziers(((orders && orders.length)? orders : undefined),
    ((types && types.length)? types : undefined),
    ((name)? name : undefined),
    ((mix)? mix : undefined));

if(file) {
    const { resolve, dirname } = require('path');
    const { writeFileSync } = require('fs');
    const mkdirp = require('mkdirp');

    const filePath = resolve(file);
    const dirPath = dirname(filePath);

    mkdirp.sync(dirPath);
    writeFileSync(filePath, beziers);
}
else {
    process.stdout.write(beziers);
}
